<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />

    <!--
    BeaqleJS - HTML5 and JavaScript framework for listening tests, <https://github.com/HSU-ANT/beaqlejs>

    This file and all corresponding parts of BeaqleJS are published under the GPLv3 license, <http://www.gnu.org/licenses/>
    -->


    <title>BeaqleJS</title>

    <!-- load the test config file -->
        <script src="config/Naturalness.js" type="text/javascript"></script>
        <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>

    <!---->

    <link type="text/css" href="css/smoothness/jquery-ui-1.8.18.custom.css" rel="Stylesheet" />
    <link type="text/css" href="css/styles.css" rel="Stylesheet" />

    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="js/jquery-ui.custom.min.js" type="text/javascript" ></script>
    <script src="js/beaqle.js" type="text/javascript"></script>


    <script type="text/javascript">
    /* <![CDATA[ */
        var testHandle;
        window.onload=function() {

            // Uncomment one of the following lines to choose the desired test class

            //testHandle = new MushraTest(TestConfig);    // <-- MUSHRA test class
            // testHandle = new AbxTest(TestConfig);     // <-- ABX test class
            testHandle = new MushraNoPrefTest(TestConfig)

            $('#Footer').prepend(testHandle.browserFeatureString() + '<br/>');
        };
    /* ]]> */
    </script>

</head>

<body>

<div id="Wrapper">

    <div id="TestTitle" class="commonBox">
        <!-- overall title at the top
             DO NOT EDIT! This box is automatically filled with content!
        -->
        Loading...
    </div>

    <!-- is displayed during load -->
    <div id="LoadOverlay" class="commonBox">
        <img src="img/ajax-loader.gif"/> &nbsp;&nbsp;&nbsp; Loading...
    </div>

    <!-- introduction before the test starts -->
    <div id="TestIntroduction" class="commonBox">

        <!-- edit here if you want to change the welcome message  and instructions -->

        <div style="text-align:left">
            Thanks for your interest in participating in the synthesized speech naturalness listening test. 
            The overall test contains 10 utterances, each of which has 4 versions. 
            Please drag the slider to score the naturalness of each version.
            The naturalness is a value of how much you think this utterance comes from a normal human speech.
            Note that different wavs may have different sound quality, but this should not be the scoring criteria. Please take the time and carefully rate every item.
            <br />
            感谢您参与此合成语音自然度测试。整个测试包含10条句子，每条句子包含4个不同的版本，请拖动滑块为每条句子的<b>自然度</b>打分。
            自然度即您多大程度上认为这条语音是一个人类所正常说出的。
            注意：每条语音的音质可能略有不同，但这不应作为评分的依据，本次测试的唯一评分依据是说话的自然度（连贯性、合理性）等。
            <br />
            <br />
            Instructions:
            <ul>
                <li>Most important: use high quality studio headphones and a quiet environment!</li>
                <li>Listen through all test files and test sets before you do any ratings to get used to the material.</li>
                <li>Try to rate the overall impression of a test item and don't concentrate on single aspects. </li>
            </ul>
            说明：
            <ul>
                <li>首先，请务必确保您使用较高质量的耳机设备，且处于较安静的环境中。</li>
                <li>对于每一个句子，请听完整条语音后，再对其进行打分。</li>
                <li>请给整体的自然度进行打分，且请确保您在每个子测试中的打分标准一致。</li>
            </ul>
            After the test, press the "Submit Results" button to finish the test.
            <br />
            成功提交测试结果后，即可关闭页面。
        </div>
        <br />
        <br />

        <!-- this button starts the first test -->
        <button id="BtnStartTest" onclick="testHandle.startTests();">Start!</button>
    </div>

    <!-- final text after all tests have passed -->
    <div id="TestEnd" class="commonBox">

        <!-- edit here if you want to change the thank you message -->
        Thank you very much!
        <br />
        <br/>
        <script type="text/javascript">
            // alert('adad');
            var display_res = function (email_to, exp_type) {
                var res = testHandle.getTestResults();
                alert(res)
            };
            var email_results = function (email_to, exp_type) {
                // var res = testHandle.getTestResults();
                // alert(res);
                var templateParams = {
                    to_name: email_to,
                    message: testHandle.getTestResults(),
                    exp_type: exp_type
                };
                // emailjs.send(serviceID, templateID, templateParams, userID);
                emailjs.send('service_ewbvwh8', 'template_fu9t4bv', templateParams, "user_nCgMakopGhhOHYlV0RFsR")
                    .then(function (response) {
                        alert("提交成功！");
                    }, function (error) {
                        alert("Failed");
                    });
            }
        </script>
        <!-- show some informations before submitting the results -->
        <div id="SubmitBox">
            <div id="SubmitError" class="error">
                We are sorry, but the following error occured during your submission:
                <p id="ErrorCode"></p>
            </div>
            <p class="submitOnline">
                <!-- edit here if you want to change the information about online submission, e.g. add privacy policy information -->
                Please submit the results to our server. Entering a name or email address is not mandatory
                but it would help us to contact you if we have further questions. You can also leave a comment.
                <br />
                email和comment两栏并不是必须的，不过您可以通过comment一栏来给出建议。
            </p>
            <p class="submitDownload">
                <!-- edit here if you want to change the information about online submission, e.g. add privacy policy information -->
                Please submit the results. If there's not a window showing success ejected a few seconds later, please click "Download" to save the results. Entering a name or email address is not mandatory
                but it would help us to contact you if we have further questions. You can also leave a comment. After successfully submitting the results, you can go back and do other tests, or close the page.
                <br />
                name、email和comment几栏并不是必须的，不过您可以通过comment来向我们提出建议。请点击“Submit Results”按钮以提交结果，正常情况下页面上会显示成功提交，如果一直没有，则请点击Download按钮下载结果，并将txt文件保存。随后您可以返回主页面选择其他测试，或关闭页面。
            </p>
            <table border=0 style="margin-left: auto;margin-right: auto;">
            <tr><td>Name:</td><td><input id="UserName" type="text" size="40" maxlength="40" /></td></tr>
            <tr><td>Email:</td><td><input id="UserEMail" type="text" size="40" maxlength="40" /></td></tr>
            <tr><td></td><td><textarea id="UserComment" cols="40" rows="4">Your comment...</textarea></td></tr>
            </table>
            <br />
            <button id="BtnSubmitData" class="submitOnline" onclick="testHandle.SubmitTestResults();">Submit</button>
            <button id="BtnDownloadData" class="submitDownload" onclick="testHandle.DownloadTestResults();">Download</button>
            <button id="EmailSubmitData" class="submitDownload" onclick="email_results('cantabile_kwok@sjtu.edu.cn','naturalness')">Submit Results提交结果</button>
            <button onclick="window.location.href='./index.html'" type="button" id="Jump">Back to main page</button>
            <p class="submitEmail error">
                <!-- edit here if you want to change the information about email submission, e.g. add privacy policy information -->
                Results should be send to <span class="supervisorEmail"></span>
            </p>
        </div>

        <!-- the test results are displayed in this box -->
        <div id="ResultsBox">
        </div>
    </div>

    <div id="TableContainer" class="commonBox">
        <!-- container for the test items and sliders
             DO NOT EDIT! This box is automatically filled with content!
        -->

        <!-- heading for the single test -->
        <div id="TestHeading">
        </div>

    </div>

    <!-- controls to go to next/previous test -->
    <div id="TestControls" class="commonBox">
        <button id="BtnNextTest">Next Test</>
        <button id="BtnPrevTest">Previous Test</>
    </div>

    <!-- playback control -->
    <div id="PlayerControls" class="commonBox">

        <div id="duration">
            <span>00:00</span>
        </div>

        <div id="TimeLine">
            <div id="ProgressBar"></div>
            <div id="ABRange"></div>
        </div>

        <div>
            <input id="ChkLoopAudio" type="checkbox" value="Loop" /><label for="ChkLoopAudio">Loop</label>
            <input id="ChkAutoReturn" type="checkbox" value="Auto Return" /><label for="ChkAutoReturn">Auto Return</label>
        </div>

        <div id="Volume">
            Volume
            <div id="VolumeSlider"></div>
        </div>

        <br style="clear:both"/>

    </div>

    <!-- Footer -->
    <div id="Footer">
        This listening test has been created with <a href="https://github.com/HSU-ANT/beaqlejs" target="_blank">BeaqleJS</a> <a href="https://github.com/HSU-ANT/beaqlejs/tree/master" target="_blank">master</a>.
    </div>
</div>

</body>

</html>
