<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />

    <!--
    BeaqleJS - HTML5 and JavaScript framework for listening tests, <https://github.com/HSU-ANT/beaqlejs>

    This file and all corresponding parts of BeaqleJS are published under the GPLv3 license, <http://www.gnu.org/licenses/>
    -->


    <title>BeaqleJS</title>

    <!-- load the test config file -->
        <script src="config/Control_d_all.js" type="text/javascript"></script>
        <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <!---->

    <link type="text/css" href="css/smoothness/jquery-ui-1.8.18.custom.css" rel="Stylesheet" />
    <link type="text/css" href="css/styles.css" rel="Stylesheet" />

    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="js/jquery-ui.custom.min.js" type="text/javascript" ></script>
    <script src="js/beaqle.js" type="text/javascript"></script>


    <script type="text/javascript">
    /* <![CDATA[ */
        var testHandle;
        window.onload=function() {

            // Uncomment one of the following lines to choose the desired test class

            testHandle = new MushraTest(TestConfig);    // <-- MUSHRA test class
            // testHandle = new AbxTest(TestConfig);     // <-- ABX test class
            // testHandle = new MushraNoPrefTest(TestConfig)

            $('#Footer').prepend(testHandle.browserFeatureString() + '<br/>');
        };
    /* ]]> */
    </script>

</head>

<body>

<div id="Wrapper">

    <div id="TestTitle" class="commonBox">
        <!-- overall title at the top
             DO NOT EDIT! This box is automatically filled with content!
        -->
        Loading...
    </div>

    <!-- is displayed during load -->
    <div id="LoadOverlay" class="commonBox">
        <img src="img/ajax-loader.gif"/> &nbsp;&nbsp;&nbsp; Loading...
    </div>

    <!-- introduction before the test starts -->
    <div id="TestIntroduction" class="commonBox">

        <!-- edit here if you want to change the welcome message  and instructions -->

        <div style="text-align:left">
            Thanks for your interest in participating in this listening test. The overall test will roughly take 6-7 minutes. Please take the time and carefully rate every item.
            <br />
            感谢您参加此次听音测试。本次测试共将花费6-7分钟左右，请仔细地阅读下面的说明。
            <br />
            <br />
            This is a test about prosody controllability. Prosody can be thought as the rich variability of speech even for the same text. There are 5 subtests. In each of them, you will be given a <b>reference speech</b>, and 5 synthesized utterances. The reference speech contains several words that we determine to have common prosodies. The five synthesized speeches, whose transcript is shown on the page, has exactly one word (marked red) that imitates the reference speech's prosody. You are asked to score the given word in every test utterance upon its prosody similarity with the reference speech. Drag the slider to give your score among 0 to 100.
            <br />
            <br />

            这是一个关于韵律控制力的测试。韵律可被理解成是同一文本对应发音的多样性，例如<b>高亢、低沉、音调升降</b>等。
            共有10个子测试，每个均会给出一条<font color='#FF0000'>参考语音</font>，以及五条合成出的<font color='#0000FF'>测试语音</font>。
            页面上有一个词会被标出，这个词在所有句子中都只出现一次。
            您需要给这五条<font color='#0000FF'>测试语音</font>打分，打分的依据是<b>标出的词的韵律与<font color='#FF0000'>参考语音</font>中这个词的相似程度</b>。您可以拖动页面上的滑块来进行打分，从左到右是0到100分。
            <br />
            <br />
            Instructions:
            <ul>
                <li>Most important: use high quality studio headphones and a good soundcard!</li>
                <li>Listen through all test files and test sets before you do any ratings to get used to the material.</li>
                <li>Rate the quality of the test items only compared to the reference on top.</li>
                <li>Pay attention to the prosodic aspect of speech, e.g. pitch, tonal trajectory. In many cases slight differences count.</li>
            </ul>
            <br />
            说明：
            <ul>
                <li>首先，请确保您使用耳机，且处于相对安静的环境。</li>
                <li>请仔细听完参考语音后再听测试语音。</li>
                <li>对于每一个测试语音，请根据那个<b>标出的词的韵律</b>与参考语音的相似程度进行打分。</li>
                <li>请注意语音中的韵律特征，比如音高、声调的变化等。在这个测试中即便细节上的区别也很重要。</li>
            </ul>
        </div>
        <br />
        <br />

        <!-- this button starts the first test -->
        <button id="BtnStartTest" onclick="testHandle.startTests();">Start!</button>
    </div>

    <!-- final text after all tests have passed -->
    <div id="TestEnd" class="commonBox">

        <!-- edit here if you want to change the thank you message -->
        Thank you very much!
        <script type="text/javascript">
            // alert('adad');
            var display_res = function (email_to, exp_type) {
                var res = testHandle.getTestResults();
                alert(res)
            };
            var email_results = function (email_to, exp_type) {
                // var res = testHandle.getTestResults();
                // alert(res);
                var templateParams = {
                    to_name: email_to,
                    message: testHandle.getTestResults(),
                    exp_type: exp_type
                };
                // emailjs.send(serviceID, templateID, templateParams, userID);
                emailjs.send('service_ewbvwh8', 'template_fu9t4bv', templateParams, "user_nCgMakopGhhOHYlV0RFsR")
                    .then(function (response) {
                        alert("提交成功！");
                    }, function (error) {
                        alert("Failed");
                    });
            }
        </script>

        <br/>
        <br/>

        <!-- show some informations before submitting the results -->
        <div id="SubmitBox">
            <div id="SubmitError" class="error">
                We are sorry, but the following error occurred during your submission:
                <p id="ErrorCode"></p>
            </div>
            <p class="submitOnline">
                <!-- edit here if you want to change the information about online submission, e.g. add privacy policy information -->
                Please submit the results to our server. Entering a name or email address is not mandatory
                but it would help us to contact you if we have further questions. You can also leave a comment.
                <br />
                email和comment两栏并不是必须的，不过您可以通过comment一栏来给出建议。
            </p>
            <p class="submitDownload">
                <!-- edit here if you want to change the information about online submission, e.g. add privacy policy information -->
                Please submit the results. If there's not a window showing success ejected a few seconds later, please click "Download" to save the results. Entering a name or email address is not mandatory
                but it would help us to contact you if we have further questions. You can also leave a comment. After successfully submitting the results, you can go back and do other tests, or close the page.
                <br />
                name、email和comment几栏并不是必须的，不过您可以通过comment来向我们提出建议。请点击“Submit Results”按钮以提交结果，正常情况下页面上会显示成功提交，如果一直没有，则请点击Download按钮下载结果，并将txt文件保存。随后您可以返回主页面选择其他测试，或关闭页面。
            </p>
            <table border=0 style="margin-left: auto;margin-right: auto;">
            <tr><td>Name:</td><td><input id="UserName" type="text" size="40" maxlength="40" /></td></tr>
            <tr><td>Email:</td><td><input id="UserEMail" type="text" size="40" maxlength="40" /></td></tr>
            <tr><td></td><td><textarea id="UserComment" cols="40" rows="4">Your comment...</textarea></td></tr>
            </table>
            <br />
            <button id="BtnSubmitData" class="submitOnline" onclick="testHandle.SubmitTestResults();">Submit</button>
            <button id="BtnDownloadData" class="submitDownload" onclick="testHandle.DownloadTestResults();">Download</button>
            <button id="EmailSubmitData" class="submitDownload" onclick="email_results('cantabile_kwok@sjtu.edu.cn','control')">Submit Results提交结果</button>
            <button onclick="window.location.href='./index.html'" type="button" id="Jump">Back to main page</button>

            <p class="submitEmail error">
                <!-- edit here if you want to change the information about email submission, e.g. add privacy policy information -->
                Results should be send to <span class="supervisorEmail"></span>
            </p>
        </div>

        <!-- the test results are displayed in this box -->
        <div id="ResultsBox">
        </div>
    </div>

    <div id="TableContainer" class="commonBox">
        <!-- container for the test items and sliders
             DO NOT EDIT! This box is automatically filled with content!
        -->

        <!-- heading for the single test -->
        <div id="TestHeading">
        </div>

    </div>

    <!-- controls to go to next/previous test -->
    <div id="TestControls" class="commonBox">
        <button id="BtnNextTest">Next Test</>
        <button id="BtnPrevTest">Previous Test</>
    </div>

    <!-- playback control -->
    <div id="PlayerControls" class="commonBox">

        <div id="duration">
            <span>00:00</span>
        </div>

        <div id="TimeLine">
            <div id="ProgressBar"></div>
            <div id="ABRange"></div>
        </div>

        <div>
            <input id="ChkLoopAudio" type="checkbox" value="Loop" /><label for="ChkLoopAudio">Loop</label>
            <input id="ChkAutoReturn" type="checkbox" value="Auto Return" /><label for="ChkAutoReturn">Auto Return</label>
        </div>

        <div id="Volume">
            Volume
            <div id="VolumeSlider"></div>
        </div>

        <br style="clear:both"/>

    </div>

    <!-- Footer -->
    <div id="Footer">
        This listening test has been created with <a href="https://github.com/HSU-ANT/beaqlejs" target="_blank">BeaqleJS</a> <a href="https://github.com/HSU-ANT/beaqlejs/tree/master" target="_blank">master</a>.
    </div>
</div>

</body>

</html>
